{%extends 'frontpages/layout.html'%}

{%load i18n%}
{%load core_template_tags%}

{%block content%}

{% get_current_language as LANGUAGE_CODE %}
        <!--Breadcrumb-->
        <!-- Note -->
        
        <!-- super user, poll creator and a user who voted for the poll cannot vote on a poll -->
		<section>
			<div class="bannerimg cover-image bg-background3" data-image-src="/static/frontpages/images/banners/banner2.jpg">
				<div class="header-text mb-0">
					<div class="container">
						<div class="text-center text-white">
							<h1 class="">{% trans "Poll-Details" %}</h1>
							<ol class="breadcrumb">
								<li class="breadcrumb-item"><a href="">{% trans "Home" %}</a></li>
								<li class="breadcrumb-item"><a href="/collaborations/polls/">{% trans "Polls" %}</a></li>
								<li class="breadcrumb-item active text-white" aria-current="page">{% trans "Poll-Details" %}</li>
							</ol>
						</div>
					</div>
				</div>
			</div>
		</section>
		<!--/Breadcrumb-->

		<!--Poll Detail-->
		<section class="sptb">
            {% if poll %}
			<div class="container">
				<div class="row">
					<div class="d-block mx-auto col-lg-10 col-md-12">
						<div class="card">
                            <div class="card-header">
                                {% if user == poll.user  %}
                                <h3 style="color: lightsalmon;"> You can not vote on this poll, since you are the creator of the poll.</h3>

                                {% elif user.is_superuser == True %}
                                <h3 style="color: lightsalmon;"> Super users cannot Vote.</h3>

                                {% elif has_voted == True %}
                                <h3 style="color: lightsalmon;"> You already have voted for this poll.</h3>

                                {% else %}

                                {% endif %}
                            </div>
							<div class="card-body">
								<a href="#" class="text-body">
                                    <h2 class="font-weight-semibold text-capitalize">
                                        {% print_translated poll.title|safe poll.title_am|safe LANGUAGE_CODE %}
                                    </h2>
                                </a>

                                <div class="item7-card-desc d-flex mb-2 mt-3">
									<a href="#"><i class="fa fa-calendar-o text-muted mr-2"></i>{{poll.timestamp}}</a>
                                    <a href="#"><i class="fa fa-user text-muted mr-2" ></i>By {{poll.user}}</a>
                                    <a  style="margin-left: 5px; margin-right: 10px;" href="/chat/with/{{poll.user.username}}/" data-toggle="tooltip" data-placement="top" title="" data-original-title="Chat with staff"><i style = "color:blue;" class="fa fa-comments fa-"></i></a>
																		
                                    <a href="#"><i class="fa fa-star text-muted mr-2" style="margin-left: 10px;"></i>Total votes {{poll.count_votes}}</a>

                                </div>

								<p>{% print_translated poll.description|safe poll.description_am|safe LANGUAGE_CODE %}</p>
							</div>
                            <!--Choices-->
                            <form action="{%url 'poll_detail' id=poll.id %}" method="POST" enctype="multipart/form-data">
                                {% csrf_token %}

                                    <div class="card-body row ">
                                        {% for choice in poll.choices.all %}
                                        <div class="col-md-12 col-lg-6 d-sm-flex mt-4 sub-review-section" style="padding: 5px;">

                                            <div class="media-body border p-2">
                                                <h5 class="mt-0 mb-1 font-weight-semibold">
                                                    {% print_translated choice.choice_name|safe choice.choice_name_am|safe LANGUAGE_CODE %}
                                                </h5>
                                                <small>
                                                    {% if choice.count_votes > 1 %}
                                                    <span class="fs-14 ml-2"> {{choice.count_votes}} Votes  <i class="fa fa-star text-yellow"></i></span>
                                                    {% else  %}
                                                    <span class="fs-14 ml-2"> {{choice.count_votes}} Vote  <i class="fa fa-star text-yellow"></i></span>
                                                    {% endif %}
                                                </small><br>
                                                <p class="font-13  mb-2 mt-2">
                                                    {% print_translated choice.description|safe choice.description_am|safe LANGUAGE_CODE %}
                                                </p>

                                                <!-- if the user is the creator or has voted hide the vote button -->

                                                {% if user.is_superuser == False and not user == poll.user and not has_voted == True %}
                                                <div class = "choice-btn-group" class="badge badge-secondary">
                                                        <span class="badge badge-secondary">
                                                            <label for = "{{choice.pk}}"><span style="font-size: medium;">Vote</span></label>
                                                            <input id = "{{choice.pk}}" type="radio" name="selected_choice" value="{{choice.pk}}" />

                                                        </span>
                                                </div>

                                                {% endif %}

                                            </div>

                                        </div>
                                        {% endfor %}

                                </div>

                                <!--/Choices-->
                                {% if poll.count_choices > 0 and user.is_superuser == False and   not user == poll.user and not has_voted == True %}
                                <div class="form-group row">
                                    <label for = "remark" class="col-form-label col-lg-3"><h3>{% trans "Any Remarks" %}?</h3> </label><br><br>
                                    <textarea id="remark" name="remark" rows="4" cols="50"></textarea>
                                </div>

                                {% endif %}

                                {% if  poll.count_choices > 0 and user.is_superuser == False and not user == poll.user and not has_voted == True %}
                                <div class="text-right">
                                    <button style="padding-left: 10%; padding-right: 10%;" type="submit"
                                            class="btn btn-primary rounded-round">Submit Vote </button>
                                </div>

                                {% endif %}

                            </form>

                        </div>

					</div>
				</div>
            </div>

            {% else %}
                <h2> Poll Not found!</h2>
            {% endif %}
		</section>
		<!--/Add listing-->

		<!-- Newsletter-->
		<section class="sptb border-top bg-white">
			<div class="container">
				<div class="section-title center-block text-center">
					<h2>Subscribe To Our Newsletter</h2>
					<p>Mauris ut cursus nunc. Morbi eleifend, ligula at consectetur vehicula</p>
				</div>
				<div class="row">
					<div class="col-lg-10 col-xl-8 col-md-12 mx-auto d-block text-center">
						<div class="input-group sub-input mt-0">
							<input type="text" class="form-control input-lg " placeholder="Enter your Email">
							<div class="input-group-append ">
								<button type="button" class="btn btn-secondary btn-lg br-tr-3 br-br-3 pl-5 pr-5">
									Subscribe
								</button>
							</div>
						</div>
					</div>
				</div>
			</div>
		</section>
		<!--/Newsletter-->
{%endblock%}




