{%extends 'frontpages/layout.html'%}

{%block content%}
		<!--Breadcrumb-->
		<section>
			<div class="bannerimg cover-image bg-background3" data-image-src="/static/frontpages/images/banners/banner2.jpg">
				<div class="header-text mb-0">
					<div class="container">
						<div class="text-center text-white">
							<h1 class="">Forum </h1>
							
						</div>
					</div>
				</div>
			</div>
		</section>
		<!--/Breadcrumb-->

		<!--Add listing-->
		<section class="sptb">
			<div class="container">
				<div class="row">
					<!--Left Side Content-->
					<div class="col-xl-4 col-lg-4 col-md-12">
						<div class="card">
						 <form action="{%url 'forum_search' %}" method="POST" enctype="multipart/form-data">
						 	{%csrf_token%}
							<div class="card-body">
								<div class="input-group">
									<input type="text" name="search" class="form-control br-tl-3  br-bl-3" placeholder="Search" required>
									<div class="input-group-append ">
										
										<button type="submit" class="btn btn-secondary br-tr-3  br-br-3">
											Search
										</button></a>
									</div>
								</div>
							</div>
						</form>
						</div>
						<div class="card">
							<div class="card-header">
                                    <h3 class="card-title">Forums you created </h3> 
							</div>
							<div class="card-body p-0">
								<div class="list-catergory">
									<div class="item-list">
										<ul class="list-group mb-0">

											{%for forum in usercreated%}
											
											<li class="list-group-item border-bottom-0">
												<a href="{%url 'forum_detail' id=forum.id %}" class="text-dark">
													 {{forum.title|safe|truncatewords:20}}
													<span class="badgetext badge badge-pill badge-light mb-0 mt-1">{{forum.countComment}}</span>
												</a>

											</li>
											<li>
												<span class="badgetext badge badge-pill badge-light mb-0 mt-1">
												<a href="{%url 'admin:delete' model_name='ForumQuestion' id=forum.id%}" class = "btn btn-secondary btn-sm mt-4" onclick="return confirm('are you sure you want to delete this')"><i class="icon-trash"></i> </a>

												<a style = "padding:5px; margin-left: 10px;" class = "btn btn-secondary btn-sm mt-4"  >
												<i class="icon-pencil" style="margin-right: 5px;" ></i> 
											</a></span>
											</li>
											 

											{%endfor%}

										</ul>
									</div>
								</div>
							</div>
                        </div>
						
					</div>
					<!--/Left Side Content-->

                    


					<div class="col-xl-8 col-lg-8 col-md-12">
						<!--Add Lists-->
						
						<div class="row">
							
                            <div class="card">
                                <div class="card-header">
                                    <h3 class="card-title">{{forum.title}}</h3> 
								
									</div>
									<div class="card-header">
									{{forum.user}} 
									
									{{forum.timestamp}}
									</div> 
								

								

                                <div class="card-body">
                                    <div class="mb-0">
                                       <p>{{forum.description}}</p>
                                    </div>
                                    {%if forum.attachements%}
                                    <div class="mb-0">
                                       <a href="{{forum.attachements.url}}" download="{{forum.attachements.url}}"> 
                                   		<div class="mb-3"><b>Attachment-1</b>:{{forum.attachements}}</div>
                                   	</a>
                                    </div>
                                    {%endif%}
                                </div>
                             </div>


                                
                            </div>

                            <div class="col-xl-12 col-lg-12 col-md-12">
                            	{% for comment in forum.comments%}
								<div class="card"> 
									<div class="card-body">
										<div class="d-sm-flex mt-0 p-5 sub-review-section border border-bottom-0 br-bl-0 br-br-0">
		                                    <div class="d-flex mr-3">
		                                        <a href="#">{{comment.user.profile_image}} </a>
		                                    </div>
		                                    <div class="media-body">
		                                        <h5 class="mt-0 mb-1 font-weight-semibold">{{comment.user}}
													<span class="fs-14 ml-0" data-toggle="tooltip" data-placement="top" title="verified"><i class="fa fa-check-circle-o text-success"></i></span>
													<span class="fs-14 ml-2"> </span>
												</h5>
												{{comment.timestamp}}
												<p class="font-13  mb-2 mt-2"> 
		                                           {{comment.comment}}
		                                        </p>
		                                        


                                       {%if comment.attachements%} 
                                    <div class="mb-0">
                                       <a href="{{comment.attachements.urls}}" download="{{comment.attachements.urls}}"> 
                                   		<div class="mb-3"><b>Attachment-o</b>:{{comment.attachements.name}}</div>
                                   	</a>
                                    </div>
                                    {%endif%}
                                    		</div>
		                                    </div>
		                                    {%if user.is_authenticated %}
												<div class="col-xl-2 col-lg-2 col-md-2">
													<div class="panel-group1" id="accordion2">
														<div class="panel panel-default mb-4 border p-0">
															<div class="panel-heading1">
																	<a class="accordion-toggle collapsed" data-toggle="collapse" data-parent="#accordion2" href="#comment{{comment.id}}" aria-expanded="false"></a>
															</div>
														</div>
													</div>
												</div>
												{%endif%}
									
									<!---------------->
									{% if request.user == comment.user%}
									<div>
										<a style = "padding:5px; margin-left: 10px;" data-toggle="modal" data-target="#comment{{comment.id}}" id="{{comment.id}}" class = "btn btn-secondary btn-sm mt-4"  >
											<i class="icon-pencil" style="margin-right: 5px;" ></i>Edit 
										</a>
									</div>
									
									<div>
										<a style = "padding:5px; margin-left: 10px;" href="{%url 'admin:delete' model_name='ForumComments' id=comment.id%}" class = "btn btn-secondary btn-sm mt-4" onclick="return confirm('Are you sure you want to DELETE this')"><i class="icon-trash"></i>Delete </a>
									</div>
									{%endif%}

									<!---------------->
									<div class="modal fade" id="comment{{comment.id}}" tabindex="-1" role="dialog"  aria-hidden="true">
										<div class="modal-dialog" role="document">
										  <div class="modal-content">
											  <form action="{%url 'edit_comment' forum=forum.id id=comment.id type='ForumComments' %}" method="POST" enctype="multipart/form-data">
												{%csrf_token%}
												<div class="modal-header">
												  <h5 class="modal-title" id="examplecontactLongTitle">Comment</h5>
												  <button type="button" class="close" data-dismiss="modal" aria-label="Close">
												  <span aria-hidden="true">&times;</span>
												  </button>
												</div>
												<div class="modal-body">
												  
												  <div class="form-group">
													<input class="form-control" name="content"  value="{{comment.comment}}"> 
												  </div>
												</div>
												<div class="modal-footer">
												  <button type="submit" class="btn btn-success">Submit</button>
												</div>
											  </form>
										  </div>
										</div>
									  </div>

									  <!------------->
									
 
							<div class="container">
							<form action="{%url 'Replay_comment' id=comment.id forum=forum.id%}" method="POST" enctype="multipart/form-data">
								<div class="panel-group1" id="accordion2">
									<div class="panel panel-default mb-4 border p-0">
										
										<div id="comment{{comment.id}}" class="panel-collapse collapse active" role="tabpanel" aria-expanded="false">

									{%csrf_token%}
										{%if commentreplay.errors%}
										<div class="alert alert-danger" role="alert">
										  {{commentreplay.errors}}
										</div>
										{% endif %}
	                                                                                
	                                    <div class="form-group">
	                                        {{commentreplay.content}}
	                                    </div>

                                    <div class="mb-0">

                                   		<b>Attachment-p</b>
                                   			<div class="form-group">
	                                        {{commentreplay.attachements}}
	                                    
                                   			</div>
                                   	
                                    </div>
	                                    <div class="text-right">
											<button style="padding-left: 10%; padding-right: 10%;" type="submit" 
											href="{%url 'Replay_comment' id=comment.id forum=forum.id%}" 
												class="btn btn-primary rounded-round">Submit </button>
										</div>
									</div>
								</div>
							</div>
							</form>
							</div>
								</div>
								
							<div class="card-body p-0">
								<div class="list-catergory">
									<div class="item-list">
										<ul class="list-group mb-0">
											{%for replay in comment.commentreplay %}
											<li class="list-group-item">
													 {{replay.content}}
													 <span class="badgetext badge badge-pill badge-light mb-0 mt-1">{{replay.user}}{{" "}}
													 {{replay.timestamp}}</span>

													
													 {% if replay.attachements%}
													 
													 <a href="{{replay.attachements.url}}" download="{{replay.attachements.url}}"> 
													 <b>Attachment</b></a>
													
													{%endif%}
													 </li>
													 
										{% if request.user == replay.user%}
													
									<span class="badgetext badge badge-pill badge-light mb-0 mt-1">
										<a  data-toggle="modal" data-target="#replay{{replay.id}}" id="{{replay.id}}" class="dropdown-item" >
											<i class="icon-pencil" style="margin-right: 5px;" > Edit</i>
										</a>

										<a  href="{%url 'admin:delete' model_name='CommentReplay' id=replay.id%}"  onclick="return confirm('Are you sure you want to DELETE this')"><i class="icon-trash"></i>Delete
										 </a>
									</span>
									
									{%endif%}
													 </li>
											</ul> 
												

									<!---------------->
									<div class="modal fade" id="replay{{replay.id}}" tabindex="-1" role="dialog"  aria-hidden="true">
										<div class="modal-dialog" role="document">
										  <div class="modal-content">
											  <form action="{%url 'edit_comment' forum=forum.id id=replay.id type='CommentReplay' %}" method="POST" enctype="multipart/form-data">
												{%csrf_token%}
												<div class="modal-header">
												  <h5 class="modal-title" id="examplecontactLongTitle">Comment</h5>
												  <button type="button" class="close" data-dismiss="modal" aria-label="Close">
												  <span aria-hidden="true">&times;</span>
												  </button>
												</div>
												<div class="modal-body">
												  
												  <div class="form-group">
													<input class="form-control" name="content"  value="{{replay.content}}"> 
												  </div>
												</div>
												<div class="modal-footer">
												  <button type="submit" class="btn btn-success">Submit</button>
												</div>
											  </form>
										  </div>
										</div>
									  </div>
											
											{%endfor%}
										
									</div>
								</div>
							</div>
							
							</div>
						{%endfor%}
                            </div>
                            {%if user.is_authenticated %}

                            <div class="card ">
                                <div class="card-header ">
                                    <h3 class="card-title">Comment</h3>
                                </div>
                                <div class="card-body">
                                    <form action="" method="POST" >
										{%csrf_token%}
										{%if commentForm.errors%}
										<div class="alert alert-danger" role="alert">
										  {{commentForm.errors}}
										</div>
										{% endif %}
	                                                                                
	                                    <div class="form-group">
	                                        {{commentForm.comment}}
	                                    </div>

	                                     <div class="mb-0">

                                   			<b>Attachment</b>
                                   			<div class="form-group">
	                                        {{commentForm.attachements}}
	                                    
                                   			</div>
                                   	
                                    	</div>
	                                    <div class="text-right">
											<button style="padding-left: 10%; padding-right: 10%;" type="submit" 
											href="{%url 'forum_detail' id=forum.id%}" 
												class="btn btn-primary rounded-round">Submit </button>
										</div>
                                	</form>
                                    
                                </div>
                            </div>
                            
                            {%else%}
                            <div class="container">

		                            <div class="col-xl-6 col-lg-12 col-md-12">
		                            	<a href="{%url 'login' %}">
										<button style="padding-left: 10%; padding-right: 10%;" type="submit" 
										href="{%url 'login' %}" 
											class="btn btn-primary rounded-round">Login to comment </button>
										</a>
									</div>
							</div>
                            {%endif%}
						
                            
						</div>
						<div class="d-sm-flex">
							<h6 class="mb-0 mt-3">Showing 1 to 6 of 30 entries</h6>
							<ul class="pagination mb-lg-0 mb-5 ml-auto">
								<li class="page-item page-prev disabled">
									<a class="page-link" href="#" tabindex="-1">Prev</a>
								</li>
								<li class="page-item active"><a class="page-link" href="#">1</a></li>
								<li class="page-item"><a class="page-link" href="#">2</a></li>
								<li class="page-item"><a class="page-link" href="#">3</a></li>
								<li class="page-item page-next">
									<a class="page-link" href="#">Next</a>
								</li>
							</ul>
						</div>
					</div>
					<!--/Add Lists-->
				</div>
			</div>
		</section>
		<!--Add Listing-->

		<!-- Newsletter-->
		<section class="sptb border-top bg-white">
			<div class="container">
				<div class="section-title center-block text-center">
					<h2>Subscribe To Our Newsletter</h2>
					<p>Mauris ut cursus nunc. Morbi eleifend, ligula at consectetur vehicula</p>
				</div>
				<div class="row">
					<div class="col-lg-10 col-xl-8 col-md-12 mx-auto d-block text-center">
						<div class="input-group sub-input mt-0">
							<input type="text" class="form-control input-lg " placeholder="Enter your Email">
							<div class="input-group-append ">
								<button type="button" class="btn btn-secondary btn-lg br-tr-3 br-br-3 pl-5 pr-5">
									Subscribe
								</button>
							</div>
						</div>
					</div>
				</div>
			</div>
		</section>
		<!--/Newsletter-->


		<!-- Home Video Modal -->
		<div class="modal fade" id="homeVideo" tabindex="-1" role="dialog">
			<div class="modal-dialog modal-lg" role="document">
				<div class="modal-content">
					<button type="button" class="btn btn-default" data-dismiss="modal" onclick="pauseVid()"><i class="fa fa-times" aria-hidden="true"></i></button>
					<div class="embed-responsive embed-responsive-16by9">
						<video id="gossVideo" class="embed-responsive-item" controls="controls">
							<source src="/static/frontpages/video/300052515.mp4" type="video/mp4">
						</video>
					</div>
				</div>
			</div>
		</div>
		{%endblock%}