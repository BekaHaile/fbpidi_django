{%extends 'frontpages/company/company_layout.html'%}
{%load i18n%}
{%load core_template_tags%}

{%block title%}{{object.name}} - Event Detail{%endblock%}
{%block content%}
{% get_current_language as LANGUAGE_CODE %}
		<!--Breadcrumb-->
		<section>
			<div class="bannerimg cover-image bg-background3" data-image-src="/static/frontpages/images/banners/banner2.jpg">
				<div class="header-text mb-0">
					<div class="container">
						<div class="text-center text-white">
							<h1 class="">{% trans "Event Detail" %}</h1>
							<ol class="breadcrumb" >
                                <li class="breadcrumb-item"><a href="{% url 'company_home' pk=object.id %}">{% trans "Company Home Page" %} </a></li>
								<li class="breadcrumb-item"><a href="{% url 'company_event' pk=object.id %}">{% trans "Company Events List" %} </a> </li>
                                <li class="breadcrumb-item active text-white" aria-current="page">{% trans "Event Details" %}</li>
                            </ol>
						</div>
					</div>
				</div>
			</div>
		</section>
		<!--/Breadcrumb-->

		<!--Add listing-->
		<section class="sptb">
			<div class="container">
				<div class="row">
					<div class="d-block mx-auto col-lg-10 col-md-12">
						<div class="card">
							<div class="card-body">
								<a href="#" class="text-body"><h3 class="font-weight-semibold text-capitalize">{%print_translated obj.title obj.title_am LANGUAGE_CODE%}</h3></a>
							
								<a href="">
									<img class="img-responsive" width = "290px" height = "250" src="{{obj.company.get_image}}" alt="{{img.image.name}}">
								</a>
										
										
								
								<div class="item7-card-desc d-flex mb-2 mt-3">
									<ul class="d-flex mb-0">
										<li class="mr-5"><a href="#" class="icons"><i class="icon icon-person text-muted mr-1">{% trans "By" %}: </i><b>{% print_translated obj.company.name obj.company.name_am LANGUAGE_CODE %}</b></a></li>
											
										<li class="mr-5"><a><i class="fa fa-calendar-o text-muted mr-2"></i><b> {% trans "Start Date" %}: {{obj.start_date.date}}</b> </a></li>                                       
										<li class="mr-5"><a><i class="fa fa-calendar-o text-muted mr-2"></i><b>{% trans "End Date" %}: {{obj.end_date.date}}</b> </a></li>
									
										<!-- <div class="ml-auto">
											<a href="#" class="mr-0"><i class="fa fa-comment-o text-muted mr-2"></i>2 Comments</a>
										</div> -->
									</ul>
								</div>
								<div class="item7-card-text ml-2 mt-1">
                                    {% if obj.status == 'Open' %}
                                    <div style="background-color: green; color:white; width: fit-content; padding: 5px; " >{% trans "Open" %}</div>
                                    {%elif obj.status == 'Upcoming' %}
                                    <div style="background-color: yellow; color:black; width: fit-content; padding: 5px;" >{% trans "Upcoming" %}</div>
                                    {%elif obj.status == 'Closed' %}
                                    <div style="background-color: red; color:white; width: fit-content; padding: 5px;" >{% trans "Closed" %}</div>
                                   {%endif%}
                                </div>
                               

								{%if obj.status == "Upcoming" %}
								
									<br>
									
									<div class="col-md-6">
										<label class="col-form-label "><b>Remind me on</b> <p class = "text-muted">{% trans "From"%} {{ obj.start_date.date }} - {{obj.end_date.date}} </p></label>
										<div >
											{{event_participant_form.notify_on}}
										</div>
				
									</div>
									<br>
									
									<div class="col-md-8">
										<label class="col-form-label "><b>Your email</b></label>
										<div >
											{{event_participant_form.patricipant_email}}
										</div>
				
									</div>
									<br>						
									<div class="col-sm-4">
										<button id="remind_me_button" type="submit" class="btn bg-primary" class="badge badge-secondary" style="margin-right: 20px; color:white;">{% trans "Remind Me" %}</button>
									</div>
								{%endif%}
								
							</div>
						</div>

						<!--Comments-->
						<div class="card">
							<div class="card-header">
								<h3 class="card-title">{% trans "Event Description" %}</h3>
							</div>
							<div class="card-body">

                                <p>
                                    {% print_translated obj.description obj.description_am LANGUAGE_CODE %}
                                </p>
								<!-- <div class="d-sm-flex mt-0 p-5 sub-review-section border border-bottom-0 br-bl-0 br-br-0">
                                    <div class="d-flex mr-3">
                                        <a href="#"><img class="media-object brround avatar-md" alt="64x64" src="/static/frontpages/images/faces/male/1.jpg"> </a>
                                    </div>
                                    <div class="media-body">
                                        <h5 class="mt-0 mb-1 font-weight-semibold">Joanne Scott
											<span class="fs-14 ml-0" data-toggle="tooltip" data-placement="top" title="verified"><i class="fa fa-check-circle-o text-success"></i></span>
											<span class="fs-14 ml-2"> 4.5 <i class="fa fa-star text-yellow"></i></span>
										</h5>
										<small class="text-muted"><i class="fa fa-calendar"></i> Dec 21st  <i class=" ml-3 fa fa-clock-o"></i> 13.00  <i class=" ml-3 fa fa-map-marker"></i> Brezil</small>
                                        <p class="font-13  mb-2 mt-2">
                                           Lorem ipsum dolor sit amet, quis Neque porro quisquam est, nostrud exercitation ullamco laboris   commodo consequat.
                                        </p>
										<a href="#" class="mr-2 mt-1"><span class="badge badge-secondary">Helpful</span></a>
										<a href="" class="mr-2 mt-1" data-toggle="modal" data-target="#Comment"><span class="badge badge-light">Comment</span></a>
										<a href="" class="mr-2 mt-1" data-toggle="modal" data-target="#report"><span  class="badge badge-light">Report</span></a>
										<div class="btn-group btn-group-sm mb-1 ml-auto float-sm-right mt-1">
											<button class="btn btn-light" type="button"><i class="fa fa-thumbs-up"></i></button>
											<button class="btn btn-light" type="button"><i class="fa fa-thumbs-down"></i></button>
										</div>
									</div> -->
								</div>

								<!-- <div class="d-sm-flex p-5 sub-review-section border subsection-color br-tl-0 br-tr-0">
									<div class="d-flex mr-3">
										<a href="#"><img class="media-object brround avatar-md" alt="64x64" src="/static/frontpages/images/faces/female/2.jpg"> </a>
									</div>
									<div class="media-body">
										<h5 class="mt-0 mb-1 font-weight-semibold">Rose Slater <span class="fs-14 ml-0" data-toggle="tooltip" data-placement="top" title="verified"><i class="fa fa-check-circle-o text-success"></i></span></h5>
										<p class="font-13  mb-2 mt-2">
											Lorem ipsum dolor sit amet nostrud exercitation ullamco laboris   commodo consequat.
										</p>
										<a href="" data-toggle="modal" data-target="#Comment" class="mt-1"><span class="badge badge-default">Comment</span></a>
										<div class="btn-group btn-group-sm mb-1 ml-auto float-right mt-1">
											<button class="btn btn-light" type="button"><i class="fa fa-thumbs-up"></i></button>
											<button class="btn btn-light" type="button"><i class="fa fa-thumbs-down"></i></button>
										</div>
									</div>
								</div> -->


								<!-- <div class="d-sm-flex p-5 mt-4 border sub-review-section">
									<div class="d-flex mr-3">
										<a href="#"><img class="media-object brround avatar-md" alt="64x64" src="/static/frontpages/images/faces/male/3.jpg"> </a>
									</div>
									<div class="media-body">
										<h5 class="mt-0 mb-1 font-weight-semibold">Edward
										<span class="fs-14 ml-0" data-toggle="tooltip" data-placement="top" title="verified"><i class="fa fa-check-circle-o text-success"></i></span>
										<span class="fs-14 ml-2"> 4 <i class="fa fa-star text-yellow"></i></span>
										</h5>
										<small class="text-muted"><i class="fa fa-calendar"></i> Dec 21st  <i class=" ml-3 fa fa-clock-o"></i> 16.35  <i class=" ml-3 fa fa-map-marker"></i> UK</small>
                                        <p class="font-13  mb-2 mt-2">
                                           Lorem ipsum dolor sit amet, quis Neque porro quisquam est, nostrud exercitation ullamco laboris   commodo consequat.
                                        </p>
										<a href="#" class="mr-2 mt-1"><span class="badge badge-secondary">Helpful</span></a>
										<a href="" class="mr-2 mt-1" data-toggle="modal" data-target="#Comment"><span class="badge badge-light">Comment</span></a>
										<a href="" class="mr-2 mt-1" data-toggle="modal" data-target="#report"><span  class="badge badge-light">Report</span></a>
										<div class="btn-group btn-group-sm mb-1 ml-auto float-sm-right mt-1">
											<button class="btn btn-light" type="button"><i class="fa fa-thumbs-up"></i></button>
											<button class="btn btn-light" type="button"><i class="fa fa-thumbs-down"></i></button>
										</div>
									</div>
								</div> -->
							</div>

                            
						</div>
						<!--/Comments-->

						<!-- <div class="card mb-lg-0">
							<div class="card-header">
								<h3 class="card-title">Add a Comment</h3>
							</div>
							<div class="card-body">
								<div class="mt-2">
									<div class="form-group">
										<input type="text" class="form-control" id="name1" placeholder="Your Name">
									</div>
									<div class="form-group">
										<input type="email" class="form-control" id="email" placeholder="Email Address">
									</div>
									<div class="form-group">
										<textarea class="form-control" name="example-textarea-input" rows="6" placeholder="Write Review"></textarea>
									</div>
									<a href="#" class="btn btn-secondary">Send Reply</a>
								</div>
							</div>
						</div> -->


					</div>
				</div>
			</div>
		</section>
		<!--/Add listing-->

		<!-- Newsletter-->
		<section class="sptb border-top bg-white">
			<div class="container">
				<div class="section-title center-block text-center">
					<h2>Subscribe To Our Newsletter</h2>
					<p>Mauris ut cursus nunc. Morbi eleifend, ligula at consectetur vehicula</p>
				</div>
				<div class="row">
					<div class="col-lg-10 col-xl-8 col-md-12 mx-auto d-block text-center">
						<div class="input-group sub-input mt-0">
							<input type="text" class="form-control input-lg " placeholder="Enter your Email">
							<div class="input-group-append ">
								<button type="button" class="btn btn-secondary btn-lg br-tr-3 br-br-3 pl-5 pr-5">
									Subscribe
								</button>
							</div>
						</div>
					</div>
				</div>
			</div>
		</section>

		<!--/Newsletter-->

		<script>

			document.querySelector('#remind_me_button').onclick = function(e) {

				console.log("clicked")
                            var participant_email = document.querySelector('#participant_email');
                            var notify_on = document.querySelector("#notify_on");
                            if (participant_email.value == "" || participant_email.value == null || notify_on.value == "" ){
                                window.alert("Fill the form first!");
                            }
                           else{
                                
                               fetch("{% url 'ajax_event_participation' id=obj.id %}",
                                {
                                    method:"POST",
                                    credentials: 'same-origin',
                                    headers:{
                                        "content-Type":'application/json',
                                        'X-CSRFToken':'{{csrf_token}}'
                                    },
                                    body:JSON.stringify({
                                        'notify_on': notify_on.value,
										'participant_email':participant_email.value

									})
                                }
                               ).then(e => e.json()).then(result=>{
								   if (result['error'] == false)
									{
										window.alert(result['message']);  
									}
								   else{
											window.alert("Error occured while trying to register your reminder. Wrong Form filled!");
										}
									notify_on.value = new Date()
									participant_email.value = ""
                                             
                                    });   
                                    
                            }
                        };
        
		</script>
{%endblock%}