{%extends 'admin/base_site.html'%}
{%load crispy_forms_tags %}
{% block extrastyle %}

<script src="/static/admin/global_assets/js/plugins/forms/styling/uniform.min.js"></script>
<script src="/static/admin/global_assets/js/demo_pages/form_inputs.js"></script>

<script src="/static/admin/global_assets/js/plugins/ui/moment/moment.min.js"></script>
    <script src="/static/admin/global_assets/js/plugins/pickers/daterangepicker.js"></script>
    <script src="/static/admin/global_assets/js/plugins/pickers/anytime.min.js"></script>
    <script src="/static/admin/global_assets/js/plugins/pickers/pickadate/picker.js"></script>
    <script src="/static/admin/global_assets/js/plugins/pickers/pickadate/picker.date.js"></script>
    <script src="/static/admin/global_assets/js/plugins/pickers/pickadate/picker.time.js"></script>
    <script src="/static/admin/global_assets/js/plugins/pickers/pickadate/legacy.js"></script>
    <script src="/static/admin/global_assets/js/plugins/notifications/jgrowl.min.js"></script>
	<script src="/static/admin/global_assets/js/demo_pages/picker_date.js"></script>
	
{% endblock %}
{%block pagename%}News Form{%endblock%}
{%block content%}

<!-- Content area -->
<div class="content">
		
	{% if edit  %}        
    <div class="card">
        <div class="card-body">
            <form action="{%url 'admin:edit_news'  id=news.id %}" method="POST" enctype="multipart/form-data">
                <fieldset class="mb-3 ml-3 mr-3">
                   
                    <legend class="text-uppercase font-size-sm font-weight-bold">Edit  News </legend>
                    {%csrf_token%}
                    <div class="form-group row">
                        <label class="col-form-label col-lg-3">News Title: <Title></Title>(English) </label>
                        <div class="col-lg-9">
                            <input required type="text" name="title" class="form-control" value="{{news.title}}" id="">
                        </div>
                    </div>
                    <div class="form-group row">
                        <label class="col-form-label col-lg-3">News Title(Amharic) </label>
                        <div class="col-lg-9">
                            <input required type="text" name="title_am" class="form-control" value="{{news.title_am}}" id="">
                        </div>
                    </div>
                    <div class="form-group row">
                        <label class="col-form-label col-lg-3">News Description(English) </label>
                        <div class="col-lg-9">
                            <textarea required name="description" id="summernote" cols="30"
                                rows="10">{{news.description|safe}}</textarea>
                        </div>
                    </div>

                    <div class="form-group row">
                        <label class="col-form-label col-lg-3">News Description(Amharic) </label>
                        <div class="col-lg-9">
                            <textarea required name="description_am" class="summernote" cols="30"
                                rows="10">{{news.description_am|safe}}</textarea>
                        </div>
                    </div>

                    <div class="form-group row">
                        <label class="col-form-label col-lg-3">Add New Images:</label>
                        <div class="col-lg-9">
                            <div class="uniform-uploader">
                                <input type="file" id="images" name="images" class="form-input-styled" data-fouc="" multiple/>
                                <span class="filename" style="user-select: none;">No file selected</span>
                                <span class="action btn bg-warning" style="user-select: none;">Choose File</span>
                            </div>
                        </div>
                    </div>
        
                   		
                </fieldset>
                <div class="text-right">
                    <button style="padding-left: 2%; padding-right: 2%;" type="submit"
                        class="btn btn-primary rounded-round col-lg-2" onclick="return confirm ('Are you sure you want to Edit this News?')">Submit</button>
                </div>
            </form>
            
            <br><br>

            <h3 class= "text-center"><b>Manage Images</b> </h3>


            <div class="mt-4 mb-3 row">
                {%for image in news.get_images%}
                <div class="col-sm-6 col-lg-3">
                    <div class="card">
                        <div class="card-img-actions m-1">
                            <img class="card-img img-fluid" src="{{image.image.url}}" width ="250" height = "200" alt="">
                            <div class="card-img-actions-overlay card-img">
                                
                                <a href="{{image.image.url}}" target="blank" class="btn btn-outline bg-white text-white border-white border-2 btn-icon rounded-round" data-popup="lightbox" rel="group">
                                    <i class="icon-eye"></i>
                                </a>
                                {% if user.is_superuser or news.get_company == user.get_company%}
                                    {% if perms.collaborations.delete_newsimages %}
                                <a href="{%url 'admin:delete' model_name='NewsImage' id=image.id%}" class="btn btn-outline bg-white text-white border-white border-2 btn-icon rounded-round ml-2" onclick="return confirm ('Are you sure you want to delete this image?')">
                                    <i class="icon-trash"></i>
                                </a>

                                    {% endif %}
                                {% endif %}
                            </div>
                        </div>
                    </div>
                </div>
                {%endfor%}
            </div>
                
        </div>

    </div>



			
	{%else%}
		
			<div class="card">

				<div class="card-body">

					<form action="{%url 'admin:create_news'%}" method="POST" class="wizard-form steps-enable-all" enctype="multipart/form-data">
						<fieldset class="mb-3 ml-3 mr-3">
							<legend class="text-uppercase font-size-sm font-weight-bold">Create new News</legend>
							<p class="mb-4"> All Fields ending with * are required. You are required to fill fields in English and Amharic</p>
							{{form.errors}}
						
							{%csrf_token%}
						
							
							<div class="form-group row">
								<label class="col-form-label col-lg-3">News Title(English) *</label>
								<div class="col-lg-9">
									{{form.title}}
								</div>
							</div>
							<div class="form-group row">
								<label class="col-form-label col-lg-3">News Title(Amharic) *</label>
								<div class="col-lg-9">
									{{form.title_am}}
								</div>
							</div>
							<div class="form-group row">
								<label class="col-form-label col-lg-3">{{form.description.label|title}} *</label>
								<div class="col-lg-9">
									{{form.description|safe}}
								</div>
							</div>
							
							<div class="form-group row">
								<label class="col-form-label col-lg-3">{{form.description_am.label|title}} *</label>
								<div class="col-lg-9">
									{{form.description_am|safe}}
								</div>
                            </div>

                            <div class="form-group row">
                                <label class="col-form-label col-lg-3">News Category *</label>
                                <div class="col-lg-9">
                                    <select required name="catagory"  class="form-control form-control-uniform" >
                                        {% for catagory in form.NEWS_CATAGORY %}
                                            <option  value="{{catagory.0}}">{{ catagory.0 }}</option>
                                            <div class="list-icons" style="width: 3%; display: inline-block;" >
                                                <div class="dropdown">
                                                    <a href="#" class="list-icons-item" data-toggle="dropdown">	</a>
                                                </div>
                                            </div>
                                        {%endfor%}
                                    </select>
                                </div>
                            </div>

                            <div class="form-group row">
                                <label class="col-form-label col-lg-3">Select Images:</label>
                                <div class="col-lg-9">
                                    <div class="uniform-uploader">
                                        <input type="file" id="images" name="images" class="form-input-styled" data-fouc="" multiple/>
                                        <span class="filename" style="user-select: none;">No file selected</span>
                                        <span class="action btn bg-warning" style="user-select: none;">Choose File</span>
                                    </div>
                                </div>
                            </div>
                            

						</fieldset>

						<div class="text-right">
							<button style="padding-left: 10%; padding-right: 10%;" type="submit" class="btn btn-primary rounded-round">Create News </button>
						</div>
					</form>
				</div>
			</div>
		
		
		
	{%endif%}
</div>
<!-- /content area -->
<script>
	$(document).ready(function () {
		$('#summernote').summernote();
		$('.summernote').summernote();
	});
</script>
{%endblock%}